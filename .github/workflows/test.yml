on: [push]

jobs:
  runTest:
    name: test for Jopi
    runs-on: ubuntu-latest

    steps:
      - name: checkout
        uses: actions/checkout@v2

      - name: node install
        uses: actions/setup-node@v1
        with:
          node-version: 12
          registry-url: 'https://registry.npmjs.org'
      - name: npm install
        run: npm install

      - name: lerna install
        run: npm install --global lerna

      - name: iniciar lerna
        run: lerna init

      - name: instala yarn
        run: yarn install

      - name: run yarn test
        run: yarn test

      - name: yarn Jest
        run: yarn jest --coverage

      - name: publicar a npm
        run: npm publish
        env:
          NODE_AUTH_TOKEN: 66177afd-25d9-47d4-baf4-9f6376f00342
